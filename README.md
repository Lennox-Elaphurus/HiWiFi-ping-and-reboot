# HiWiFi ping and reboot
用于解决校园网连接不稳定的情况。

## 问题

最近校园网总是让路由器莫名其妙地掉线，而极路由的H3C认证在掉线后不会自动重启，导致WIFI无法联网。

## 解决思路

在极路由的开发者模式下，每3分钟ping一轮baidu.com以确认路由器是否联网，如断网则在等待180秒后重启路由器。

## 步骤

1. 在“智能插件”中启用“开发者模式”插件

   - 需要联网才能使用智能插件
   - 开启开发者模式需要按提示申请

2. 通过ssh连接路由器

   - root系统的SSH端口号为1022，用户名: root，密码: 路由器后台密码；

3. 将pingLocal.sh文件复制到/root目录中

   - 登录ssh后的当前目录就是/root目录，可以通过pwd命令查看当前目录
   - 极路由好像没有开ftp，需要新建文件手动复制文件内容实现文件复制
     1. `vi pingLocal.sh`
     2. 按下键盘上的字母`i`进入输入模式
     3. 粘贴pingLocal.sh的内容（中文注释会无法显示，不影响程序运行）
     4. 按下键盘上的`Esc`键退出输入模式
     5. 输入`:wq`保存并退出
     6. `chmod 777 pingLocal.sh`添加文件执行权限，如果只添加x似乎会无法用crontab启动

   - 在crontab中设置定时任务
     1. `crontab -e`
     2. 按下键盘上的字母`i`进入输入模式
     3. 在文件末尾输入`*/3 * * * * sh /root/pingLocal.sh  >/root/ping.log 2>&1 `（每3分钟执行一次pingLocal.sh ，将所有输出以覆盖的方式写入ping.log文件）
     4. 按下键盘上的`Esc`键退出输入模式
     5. 输入`:wq`保存并退出

## 查看执行情况

在/root目录下用`tail ping.log`查看程序的输出

## 改进

可能有方法可以只重启H3C认证而不用重启整个路由器来实现相同的功能

2020.12.02	其实好像没有必要重启路由器，插拔一次网线就可以正常连接了。